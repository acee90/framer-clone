# GitHub Pagesë¥¼ í†µí•´ ì •ì  ì½˜í…ì¸ ë¥¼ ë°°í¬í•˜ëŠ” ê°„ë‹¨í•œ ì›Œí¬í”Œë¡œìš°
name: Deploy static content to Pages

on:
  # ê¸°ë³¸ ë¸Œëœì¹˜ì— ëŒ€í•œ í‘¸ì‹œ ì´ë²¤íŠ¸ ë°œìƒ ì‹œ ì‹¤í–‰
  push:
    branches: ["main"] # â—ï¸ main ë¸Œëœì¹˜ê°€ ë§ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

  # Actions íƒ­ì—ì„œ ìˆ˜ë™ìœ¼ë¡œ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±
  workflow_dispatch:

# GITHUB_TOKENì˜ ê¶Œí•œì„ ì„¤ì •í•˜ì—¬ GitHub Pagesì— ë°°í¬í•  ìˆ˜ ìˆë„ë¡ í•¨
permissions:
  contents: read
  pages: write
  id-token: write

# ë™ì‹œì— í•˜ë‚˜ì˜ ë°°í¬ë§Œ í—ˆìš©í•˜ë„ë¡ êµ¬ì„±
concurrency:
  group: "pages"
  cancel-in-progress: true

jobs:
  # ë‹¨ìˆœíˆ ë°°í¬ë§Œ ìˆ˜í–‰í•˜ê¸°ì— í•˜ë‚˜ì˜ ì¡ìœ¼ë¡œë§Œ êµ¬ì„±
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Set up Bun
        uses: oven-sh/setup-bun@v2
        with:
          bun-version: latest
      - name: Install dependencies
        run: bun install --frozen-lockfile
      - name: Build
        run: bun run build # ğŸ‘ˆ 1. ë¹Œë“œê°€ ì™„ë£Œë˜ë©´ 'dist' í´ë”ê°€ ìƒì„±ë©ë‹ˆë‹¤.

      # â—ï¸ 2. ì´ ë‹¨ê³„ë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤!
      #    'dist' í´ë” ì•ˆì˜ index.htmlì„ 404.htmlë¡œ ë³µì‚¬í•©ë‹ˆë‹¤.
      - name: Create 404.html
        run: cp dist/index.html dist/404.html

      - name: Setup Pages
        uses: actions/configure-pages@v5

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          # 3. ì´ì œ 'dist' í´ë”ì—ëŠ” index.htmlê³¼ 404.htmlì´ ëª¨ë‘ í¬í•¨ë©ë‹ˆë‹¤.
          path: "./dist"

      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
